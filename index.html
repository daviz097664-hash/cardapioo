<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Card√°pio Gar√ßom - Oficial</title>
    
    <link rel="icon" type="image/jpeg" href="IMG_4557.jpeg">
    <link rel="apple-touch-icon" href="IMG_4557.jpeg">
    <meta name="apple-mobile-web-app-capable" content="yes">

    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { background-color: #000; color: #fff; font-family: sans-serif; padding: 20px; padding-bottom: 120px; }
        header { text-align: center; margin-bottom: 20px; border-bottom: 2px solid #ffc107; padding-bottom: 10px; }
        header h1 { color: #ffc107; font-size: 1.5rem; text-transform: uppercase; }
        
        .secao-identificacao input { 
            width: 100%; padding: 15px; background: #222; border: 1px solid #ffc107; 
            color: #fff; border-radius: 8px; margin-bottom: 20px; font-size: 1rem;
        }

        h2 { color: #ffc107; margin: 25px 0 10px 0; border-left: 4px solid #ffc107; padding-left: 10px; font-size: 1.2rem; text-transform: uppercase; }
        
        .item { background: #111; border: 1px solid #333; border-radius: 10px; padding: 15px; margin-bottom: 15px; }
        .info h3 { color: #fff; margin-bottom: 2px; font-size: 1.1rem; }
        .info p { color: #aaa; font-size: 0.85rem; margin-bottom: 10px; line-height: 1.2; }
        
        .input-obs { background: #1a1a1a; border: 1px solid #444; color: #ffc107; padding: 10px; border-radius: 5px; width: 100%; font-size: 0.9rem; margin-bottom: 12px; }
        .rodape-item { display: flex; justify-content: space-between; align-items: center; }
        .preco { color: #4caf50; font-weight: bold; font-size: 1.1rem; }
        .acoes { display: flex; align-items: center; gap: 15px; }
        .acoes button { background: #ffc107; border: none; width: 40px; height: 40px; font-size: 1.4rem; font-weight: bold; border-radius: 8px; cursor: pointer; }
        .quantidade { font-size: 1.4rem; font-weight: bold; min-width: 25px; text-align: center; }

        /* LISTA DE CONSUMO ATIVO */
        .card-consumo { background: #111; border: 1px solid #ffc107; border-radius: 10px; padding: 15px; margin-bottom: 15px; border-left: 6px solid #ffc107; }
        .cliente-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #333; padding-bottom: 8px; margin-bottom: 10px; }
        .lista-itens { color: #eee; font-size: 0.95rem; line-height: 1.4; white-space: pre-wrap; margin-bottom: 15px; background: #1a1a1a; padding: 10px; border-radius: 5px; }
        .total-consumo { color: #4caf50; font-weight: bold; font-size: 1.2rem; text-align: right; }

        .btn-acao { border: none; padding: 12px; border-radius: 8px; font-weight: bold; cursor: pointer; margin-top: 10px; }
        .btn-edit { background: #2196f3; color: white; width: 48%; }
        .btn-pix { background: #00bfa5; color: white; width: 48%; }
        .btn-fechar { background: #b02a37; color: white; width: 100%; }

        .rodape-fixo { position: fixed; bottom: 0; left: 0; width: 100%; background: #111; padding: 20px; border-top: 2px solid #ffc107; display: flex; justify-content: space-between; align-items: center; z-index: 100; }
        #total { font-size: 1.3rem; font-weight: bold; color: #ffc107; }
        #enviar { background: #4caf50; color: #fff; border: none; padding: 15px 25px; border-radius: 8px; font-weight: bold; font-size: 1rem; }

        /* Modal PIX */
        #modal-pix { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: #fff; color: #000; padding: 20px; border-radius: 15px; text-align: center; width: 90%; z-index: 1001; }
        .overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000; }
    </style>
</head>
<body>

<header><h1>Card√°pio Gar√ßom</h1></header>

<div class="secao-identificacao">
    <input type="hidden" id="pedido-id-edicao">
    <input type="text" id="nome-cliente" placeholder="NOME DO CLIENTE OU MESA (Obrigat√≥rio)">
</div>

<main class="cardapio">
    <h2>üçî P√£o de Hamb√∫rguer</h2>
    <div class="item"><div class="info"><h3>X-burguer</h3><p>Hamb√∫rguer, presunto, mussarela, ketchup e maionese</p><input type="text" id="obs-X-burguer" class="input-obs" placeholder="Obs..."></div><div class="rodape-item"><div class="preco">R$ 16,00</div><div class="acoes"><button onclick="removerItem('X-burguer', 16)">-</button><span id="qtd-X-burguer" class="quantidade">0</span><button onclick="addItem('X-burguer', 16)">+</button></div></div></div>
    <div class="item"><div class="info"><h3>X-Salada</h3><p>Hamb√∫rguer, presunto, mussarela, salada e maionese</p><input type="text" id="obs-X-Salada" class="input-obs" placeholder="Obs..."></div><div class="rodape-item"><div class="preco">R$ 18,00</div><div class="acoes"><button onclick="removerItem('X-Salada', 18)">-</button><span id="qtd-X-Salada" class="quantidade">0</span><button onclick="addItem('X-Salada', 18)">+</button></div></div></div>
    <div class="item"><div class="info"><h3>X-EGG</h3><p>Hamb√∫rguer, ovo, presunto, mussarela e salada</p><input type="text" id="obs-X-EGG" class="input-obs" placeholder="Obs..."></div><div class="rodape-item"><div class="preco">R$ 20,00</div><div class="acoes"><button onclick="removerItem('X-EGG', 20)">-</button><span id="qtd-X-EGG" class="quantidade">0</span><button onclick="addItem('X-EGG', 20)">+</button></div></div></div>
    <div class="item"><div class="info"><h3>X-Bacon</h3><p>Hamb√∫rguer, bacon, presunto, mussarela e salada</p><input type="text" id="obs-X-Bacon" class="input-obs" placeholder="Obs..."></div><div class="rodape-item"><div class="preco">R$ 25,00</div><div class="acoes"><button onclick="removerItem('X-Bacon', 25)">-</button><span id="qtd-X-Bacon" class="quantidade">0</span><button onclick="addItem('X-Bacon', 25)">+</button></div></div></div>
    <div class="item"><div class="info"><h3>X-Tudo</h3><p>Hamb√∫rguer, bacon, ovo, presunto, mussarela e salada</p><input type="text" id="obs-X-Tudo" class="input-obs" placeholder="Obs..."></div><div class="rodape-item"><div class="preco">R$ 28,00</div><div class="acoes"><button onclick="removerItem('X-Tudo', 28)">-</button><span id="qtd-X-Tudo" class="quantidade">0</span><button onclick="addItem('X-Tudo', 28)">+</button></div></div></div>

    <h2>ü•ñ P√£o Franc√™s</h2>
    <div class="item"><div class="info"><h3>Misto Quente</h3><p>Presunto e mussarela</p><input type="text" id="obs-Misto-Quente" class="input-obs" placeholder="Obs..."></div><div class="rodape-item"><div class="preco">R$ 10,00</div><div class="acoes"><button onclick="removerItem('Misto-Quente', 10)">-</button><span id="qtd-Misto-Quente" class="quantidade">0</span><button onclick="addItem('Misto-Quente', 10)">+</button></div></div></div>
    <div class="item"><div class="info"><h3>Misto c/ Ovo</h3><p>Presunto, mussarela e ovo</p><input type="text" id="obs-Misto-Ovo" class="input-obs" placeholder="Obs..."></div><div class="rodape-item"><div class="preco">R$ 13,00</div><div class="acoes"><button onclick="removerItem('Misto-Ovo', 13)">-</button><span id="qtd-Misto-Ovo" class="quantidade">0</span><button onclick="addItem('Misto-Ovo', 13)">+</button></div></div></div>
    <div class="item"><div class="info"><h3>X-Calabresa</h3><p>Calabresa acebolada e mussarela</p><input type="text" id="obs-X-Calabresa" class="input-obs" placeholder="Obs..."></div><div class="rodape-item"><div class="preco">R$ 15,00</div><div class="acoes"><button onclick="removerItem('X-Calabresa', 15)">-</button><span id="qtd-X-Calabresa" class="quantidade">0</span><button onclick="addItem('X-Calabresa', 15)">+</button></div></div></div>
    <div class="item"><div class="info"><h3>Lingui√ßa</h3><p>Lingui√ßa artesanal acebolada e mussarela</p><input type="text" id="obs-Linguica" class="input-obs" placeholder="Obs..."></div><div class="rodape-item"><div class="preco">R$ 15,00</div><div class="acoes"><button onclick="removerItem('Linguica', 15)">-</button><span id="qtd-Linguica" class="quantidade">0</span><button onclick="addItem('Linguica', 15)">+</button></div></div></div>
    <div class="item"><div class="info"><h3>Contra-fil√©</h3><p>Contra-fil√© e mussarela</p><input type="text" id="obs-Contra-file" class="input-obs" placeholder="Obs..."></div><div class="rodape-item"><div class="preco">R$ 20,00</div><div class="acoes"><button onclick="removerItem('Contra-file', 20)">-</button><span id="qtd-Contra-file" class="quantidade">0</span><button onclick="addItem('Contra-file', 20)">+</button></div></div></div>

    <h2>ü•§ Refrigerantes</h2>
    <div class="item"><div class="info"><h3>Coca Normal Lata</h3></div><div class="rodape-item"><div class="preco">R$ 7,00</div><div class="acoes"><button onclick="removerItem('Coca-Lata', 7)">-</button><span id="qtd-Coca-Lata" class="quantidade">0</span><button onclick="addItem('Coca-Lata', 7)">+</button></div></div></div>
    <div class="item"><div class="info"><h3>Coca Zero Lata</h3></div><div class="rodape-item"><div class="preco">R$ 7,00</div><div class="acoes"><button onclick="removerItem('Coca-Zero', 7)">-</button><span id="qtd-Coca-Zero" class="quantidade">0</span><button onclick="addItem('Coca-Zero', 7)">+</button></div></div></div>
    <div class="item"><div class="info"><h3>Guaran√° Antarctica Lata</h3></div><div class="rodape-item"><div class="preco">R$ 7,00</div><div class="acoes"><button onclick="removerItem('Guarana-Lata', 7)">-</button><span id="qtd-Guarana-Lata" class="quantidade">0</span><button onclick="addItem('Guarana-Lata', 7)">+</button></div></div></div>
    <div class="item"><div class="info"><h3>Sprite Lata</h3></div><div class="rodape-item"><div class="preco">R$ 7,00</div><div class="acoes"><button onclick="removerItem('Sprite-Lata', 7)">-</button><span id="qtd-Sprite-Lata" class="quantidade">0</span><button onclick="addItem('Sprite-Lata', 7)">+</button></div></div></div>
    <div class="item"><div class="info"><h3>Fanta Laranja Lata</h3></div><div class="rodape-item"><div class="preco">R$ 7,00</div><div class="acoes"><button onclick="removerItem('Fanta-Lar-Lata', 7)">-</button><span id="qtd-Fanta-Lar-Lata" class="quantidade">0</span><button onclick="addItem('Fanta-Lar-Lata', 7)">+</button></div></div></div>
    <div class="item"><div class="info"><h3>Fanta Uva Lata</h3></div><div class="rodape-item"><div class="preco">R$ 7,00</div><div class="acoes"><button onclick="removerItem('Fanta-Uva-Lata', 7)">-</button><span id="qtd-Fanta-Uva-Lata" class="quantidade">0</span><button onclick="addItem('Fanta-Uva-Lata', 7)">+</button></div></div></div>
    <div class="item"><div class="info"><h3>Coca 600ml</h3></div><div class="rodape-item"><div class="preco">R$ 10,00</div><div class="acoes"><button onclick="removerItem('Coca-600ml', 10)">-</button><span id="qtd-Coca-600ml" class="quantidade">0</span><button onclick="addItem('Coca-600ml', 10)">+</button></div></div></div>
    <div class="item"><div class="info"><h3>Coca 1 Litro</h3></div><div class="rodape-item"><div class="preco">R$ 12,00</div><div class="acoes"><button onclick="removerItem('Coca-1L', 12)">-</button><span id="qtd-Coca-1L" class="quantidade">0</span><button onclick="addItem('Coca-1L', 12)">+</button></div></div></div>

    <h2>‚ûï Adicionais</h2>
    <div class="item"><div class="info"><h3>Ovo Extra</h3></div><div class="rodape-item"><div class="preco">R$ 3,00</div><div class="acoes"><button onclick="removerItem('Ovo-Extra', 3)">-</button><span id="qtd-Ovo-Extra" class="quantidade">0</span><button onclick="addItem('Ovo-Extra', 3)">+</button></div></div></div>
    <div class="item"><div class="info"><h3>Hamb√∫rguer Extra</h3></div><div class="rodape-item"><div class="preco">R$ 5,00</div><div class="acoes"><button onclick="removerItem('Burger-Extra', 5)">-</button><span id="qtd-Burger-Extra" class="quantidade">0</span><button onclick="addItem('Burger-Extra', 5)">+</button></div></div></div>
    <div class="item"><div class="info"><h3>Bacon Extra</h3></div><div class="rodape-item"><div class="preco">R$ 5,00</div><div class="acoes"><button onclick="removerItem('Bacon-Extra', 5)">-</button><span id="qtd-Bacon-Extra" class="quantidade">0</span><button onclick="addItem('Bacon-Extra', 5)">+</button></div></div></div>
    <div class="item"><div class="info"><h3>Mussarela Extra</h3></div><div class="rodape-item"><div class="preco">R$ 4,00</div><div class="acoes"><button onclick="removerItem('Queijo-Extra', 4)">-</button><span id="qtd-Queijo-Extra" class="quantidade">0</span><button onclick="addItem('Queijo-Extra', 4)">+</button></div></div></div>

    <h2>üçπ Sucos Naturais</h2>
    <div class="item"><div class="info"><h3>Suco de Laranja</h3><p>500ml</p><input type="text" id="obs-Suco-Laranja" class="input-obs" placeholder="Obs..."></div><div class="rodape-item"><div class="preco">R$ 10,00</div><div class="acoes"><button onclick="removerItem('Suco-Laranja', 10)">-</button><span id="qtd-Suco-Laranja" class="quantidade">0</span><button onclick="addItem('Suco-Laranja', 10)">+</button></div></div></div>
    <div class="item"><div class="info"><h3>Suco de Maracuj√°</h3><p>500ml</p><input type="text" id="obs-Suco-Maracuja" class="input-obs" placeholder="Obs..."></div><div class="rodape-item"><div class="preco">R$ 10,00</div><div class="acoes"><button onclick="removerItem('Suco-Maracuja', 10)">-</button><span id="qtd-Suco-Maracuja" class="quantidade">0</span><button onclick="addItem('Suco-Maracuja', 10)">+</button></div></div></div>

    <h2>üç∫ Cervejas</h2>
    <div class="item"><div class="info"><h3>Brahma</h3></div><div class="rodape-item"><div class="preco">R$ 6,00</div><div class="acoes"><button onclick="removerItem('Brahma', 6)">-</button><span id="qtd-Brahma" class="quantidade">0</span><button onclick="addItem('Brahma', 6)">+</button></div></div></div>
    <div class="item"><div class="info"><h3>Skol</h3></div><div class="rodape-item"><div class="preco">R$ 6,00</div><div class="acoes"><button onclick="removerItem('Skol', 6)">-</button><span id="qtd-Skol" class="quantidade">0</span><button onclick="addItem('Skol', 6)">+</button></div></div></div>
    <div class="item"><div class="info"><h3>Heineken</h3></div><div class="rodape-item"><div class="preco">R$ 9,00</div><div class="acoes"><button onclick="removerItem('Heineken', 9)">-</button><span id="qtd-Heineken" class="quantidade">0</span><button onclick="addItem('Heineken', 9)">+</button></div></div></div>

    <hr style="border: 1px dashed #ffc107; margin: 40px 0;">

    <div class="consumo-container">
        <h2>üìë Consumo por Cliente</h2>
        <div id="lista-consumo"></div>
    </div>
</main>

<div id="overlay-pix" class="overlay" onclick="fecharPix()"></div>
<div id="modal-pix">
    <h3>Pagamento PIX</h3>
    <p style="font-size: 0.8rem;">Chave CPF: 410.160.938-10</p>
    <div id="qrcode-area"></div>
    <p id="valor-pix" style="font-weight:bold; color:#4caf50; font-size:1.2rem; margin:10px 0;"></p>
    <button onclick="fecharPix()" style="background:#ffc107; border:none; padding:10px 25px; border-radius:5px; font-weight:bold;">FECHAR</button>
</div>

<footer class="rodape-fixo">
    <div id="total">Total: R$ 0,00</div>
    <button id="enviar" onclick="finalizarPedido()">LAN√áAR PEDIDO</button>
</footer>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getDatabase, ref, push, onValue, remove, update } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

    const firebaseConfig = {
        apiKey: "AIzaSyA0dHn3SXaO1Vc5cnovA7rddJN0WNrpi4k",
        authDomain: "cardapio-restaurante-df665.firebaseapp.com",
        databaseURL: "https://cardapio-restaurante-df665-default-rtdb.firebaseio.com/",
        projectId: "cardapio-restaurante-df665",
        storageBucket: "cardapio-restaurante-df665.firebasestorage.app",
        messagingSenderId: "205272470692",
        appId: "1:205272470692:web:1cfc7c7d084887a3fe4231"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    let carrinho = {};
    let totalGeral = 0;

    window.addItem = (nome, preco) => {
        if (!carrinho[nome]) carrinho[nome] = { qtd: 0, preco: preco };
        carrinho[nome].qtd++;
        atualizarUI();
    };

    window.removerItem = (nome, preco) => {
        if (carrinho[nome] && carrinho[nome].qtd > 0) {
            carrinho[nome].qtd--;
            if (carrinho[nome].qtd === 0) delete carrinho[nome];
        }
        atualizarUI();
    };

    function atualizarUI() {
        totalGeral = 0;
        document.querySelectorAll('.quantidade').forEach(span => {
            const idItem = span.id.replace('qtd-', '');
            span.innerText = carrinho[idItem] ? carrinho[idItem].qtd : 0;
        });
        for (let i in carrinho) totalGeral += (carrinho[i].qtd * carrinho[i].preco);
        document.getElementById('total').innerText = `Total: R$ ${totalGeral.toFixed(2)}`;
    }

    window.finalizarPedido = function() {
        const idEdicao = document.getElementById('pedido-id-edicao').value;
        const cliente = document.getElementById('nome-cliente').value;
        if (!cliente || totalGeral === 0) return alert("Digite o nome e adicione itens!");

        let itensTexto = "";
        for (let id in carrinho) {
            const obs = document.getElementById(`obs-${id}`)?.value || "";
            itensTexto += `${carrinho[id].qtd}x ${id.replace(/-/g, ' ')}${obs ? ' ('+obs+')' : ''}\n`;
        }

        const dados = { cliente, itens: itensTexto, total: totalGeral.toFixed(2), data: new Date().toLocaleString() };

        if (idEdicao) {
            update(ref(db, `pedidos/${idEdicao}`), dados).then(() => {
                location.reload();
            });
        } else {
            push(ref(db, 'pedidos'), dados).then(() => {
                location.reload();
            });
        }
    };

    // MOSTRAR CONSUMO EM TEMPO REAL
    onValue(ref(db, 'pedidos'), (snapshot) => {
        const pedidos = snapshot.val();
        const container = document.getElementById('lista-consumo');
        container.innerHTML = "";
        for (let id in pedidos) {
            const p = pedidos[id];
            container.innerHTML += `
                <div class="card-consumo">
                    <div class="cliente-header">
                        <strong>üë§ ${p.cliente}</strong>
                        <span style="font-size:0.8rem; color:#aaa;">${p.data.split(',')[1]}</span>
                    </div>
                    <div class="lista-itens">${p.itens}</div>
                    <div class="total-consumo">Total: R$ ${p.total}</div>
                    <div style="display:flex; justify-content:space-between; gap:10px;">
                        <button class="btn-acao btn-edit" onclick="retomarPedido('${id}', '${p.cliente}')">EDITAR ‚úèÔ∏è</button>
                        <button class="btn-acao btn-pix" onclick="gerarPix('${p.total}')">PIX üí∏</button>
                    </div>
                    <button class="btn-acao btn-fechar" onclick="fecharConta('${id}')">FECHAR CONTA / REMOVER ‚úÖ</button>
                </div>`;
        }
    });

    window.retomarPedido = (id, cliente) => {
        document.getElementById('pedido-id-edicao').value = id;
        document.getElementById('nome-cliente').value = cliente;
        document.getElementById('enviar').innerText = "ATUALIZAR CONSUMO";
        window.scrollTo(0,0);
        alert("Consumo carregado! Ajuste os itens acima e clique em ATUALIZAR.");
    };

    window.fecharConta = (id) => { if(confirm("Deseja encerrar e remover o consumo deste cliente?")) remove(ref(db, `pedidos/${id}`)); };

    window.gerarPix = (valor) => {
        const chave = "41016093810";
        const valorF = valor.replace(',', '.');
        const url = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=CHAVE:${chave}-VALOR:${valorF}`;
        document.getElementById('qrcode-area').innerHTML = `<img src="${url}">`;
        document.getElementById('valor-pix').innerText = `R$ ${valor}`;
        document.getElementById('modal-pix').style.display = 'block';
        document.getElementById('overlay-pix').style.display = 'block';
    };

    window.fecharPix = () => {
        document.getElementById('modal-pix').style.display = 'none';
        document.getElementById('overlay-pix').style.display = 'none';
    };
</script>
</body>
</html>
